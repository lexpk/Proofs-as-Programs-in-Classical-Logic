\documentclass[a4paper,12pt]{article}

\title{Embedding intuitionistic into classical logic}
\author{Alexander Pluska}

\usepackage{amsmath,amssymb,amsthm}
\usepackage{ wasysym }
\usepackage{ stmaryrd }
\usepackage{ mathpartir }
\usepackage{bussproofs}
\usepackage{enumerate}
\usepackage{tikz-qtree}
\usepackage{stackengine}

\usepackage{hyperref}% http://ctan.org/pkg/hyperref
\usepackage{cleveref}% http://ctan.org/pkg/cleveref

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\theoremstyle{definition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{lemma}[theorem]{Lemma}
\theoremstyle{definition}
\newtheorem{proposition}[theorem]{Proposition}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\theoremstyle{definition}
\newtheorem{example}[theorem]{Example}

\DeclareMathOperator*{\argmax}{arg\,max}

\begin{document}
	
	\maketitle
	
	\begin{abstract}
		The aim of this paper is for a propositional sequent to give a transformed sequent that is valid in classical logic if and only if the original one is valid in intuitionistic logic. Since intuitionistic propositional logic is decidable this is of course trivially possible, however our procedure will be local. This means that our transformation will also be sound for first-order logic, allowing us to reduce the non-intuitionistic content of such sequents which yields benefits for program extraction in a situation where only a classical prover is available. 
	\end{abstract}
	

	

	\section{Porpositional logic}
	
	Since the details of syntax are a delicate concern for proof theory we will first collect some important definitions and facts. Fix a countably infinite number of atomic propositions $A, B, C,\dots$ as well as a special atomic proposition $\bot$.
	
	\begin{definition}
		A \textit{Fomrula} can be constructed only in the following ways:
		\begin{itemize}
			\item every atomic proposition is a formula.
			\item given formulas $A, B$ we have formulas $A\wedge B, A\vee B, A\to B$.
		\end{itemize}
	 	With every formula $\varphi$ we can associate a unique labelled rooted binary tree, the \textit{syntax tree} $T(\varphi)$:
		 \begin{itemize}
		 	\item If $\varphi$ is atomic then $T(\varphi)$ consists of a single node with label $\varphi$: \tikz[scale=0.9, baseline=0mm, thick]{\node[draw] {$ \varphi$}}
		 	\item If $\varphi = \varphi_1\circ\varphi_2$ then the root node is again labelled with gamma and has two child nodes, at which the trees $T(\varphi_1)$ and $T(\varphi_2)$ are attached:
		 	\begin{center}
		 	\tikz[scale=1, baseline=-5mm, thick]{\Tree [.\node[draw]{$\varphi$}; [.$T(\varphi_1)$  ] [.$T(\varphi_2)$  ] ]}
	 		\end{center}
		 \end{itemize}
	 	$\psi$ is a \textit{subformula} of $\varphi$ if it is the label of some node of $T(\varphi)$.
	 \end{definition}
	 
	 
	 \begin{example}
	 	Consider the formula $((A\wedge B)\to A) \to (B\vee A)$. Then its syntax tree is
	 	\begin{center}
	 		\tikz[scale=1, baseline=-5mm, thick]{\Tree [.\node[draw]{$((A\to B)\to A)\to (B\vee A)$}; [.\node[draw]{$(A\to B)\to A$}; [.\node[draw]{$A\to B$}; [.\node[draw]{$A$}; ] [.\node[draw]{$B$}; ] ] [.\node[draw]{$A$}; ] ] [.\node[draw]{$B\vee A$}; [.\node[draw]{$B$}; ] [.\node[draw]{$A$};] ] ]}
	 	\end{center}
	 \end{example}
 
 	We are now ready to introduce our calculi for intuitionistic and classical logic:
	
	\begin{definition}
			A \textit{sequent} $A\Rightarrow B$ consists of two multisets of formulas $A, B$. The position of $A_i$ in $A_1,\dots, A_n\Rightarrow B_1,\dots, B_m$ is $0i$ and that of $B_i$ is $1i$. A formula $\varphi$ occurs at $p = (ji, p')$ if $\varphi$ occurs at $p'$ in $A_i$ if $j=0$ and in $B_i$ if $j=1$. The following rules make up our classical calculus $\mathbf{GC}$, corresponding roughly to the propositional fragment of \textbf{G3c} from~\cite{basicprooftheory}:\\
		\begin{center}
			\begin{tabular}{lll}
				\AxiomC{\hphantom{x}}
				\RightLabel{Ax}
				\UnaryInfC{$A,\Gamma\Rightarrow \Delta, A$}
				\DisplayProof&
				\AxiomC{\hphantom{x}}
				\RightLabel{L$\bot$}
				\UnaryInfC{$\bot,\Gamma\Rightarrow\Delta$}
				\DisplayProof&
				\\&&\\
				\AxiomC{$A, B,\Gamma\Rightarrow\Delta$}
				\RightLabel{L$\wedge$}
				\UnaryInfC{$A\wedge B, \Gamma\Rightarrow \Delta$}
				\DisplayProof&
				\AxiomC{$\Gamma\Rightarrow\Delta, A$}
				\AxiomC{$\Gamma\Rightarrow\Delta, B$}
				\RightLabel{R$\wedge$}
				\BinaryInfC{$\Gamma\Rightarrow \Delta, A\wedge B$}
				\DisplayProof&
				\\&&\\
				\AxiomC{$A, \Gamma\Rightarrow\Delta$}
				\AxiomC{$B, \Gamma\Rightarrow\Delta$}
				\RightLabel{L$\vee$}
				\BinaryInfC{$A\vee B, \Gamma\Rightarrow \Delta$}
				\DisplayProof&
				\AxiomC{$\Gamma\Rightarrow\Delta, A, B$}
				\RightLabel{R$\vee$}
				\UnaryInfC{$\Gamma\Rightarrow \Delta, A\vee B$}
				\DisplayProof&
				\\&&\\
				\AxiomC{$A\to B, \Gamma\Rightarrow\Delta, A$}
				\AxiomC{$B, \Gamma\Rightarrow\Delta$}
				\RightLabel{L$\to$}
				\BinaryInfC{$A\to B, \Gamma\Rightarrow \Delta$}
				\DisplayProof&
				\AxiomC{$A,\Gamma\Rightarrow\Delta, B$}
				\RightLabel{R$\to$}
				\UnaryInfC{$\Gamma\Rightarrow \Delta, A\to B$}
				\DisplayProof&
				\\&&\\
			\end{tabular}
		\end{center}
		
		To obtain our intuitionistic calculus \textbf{GI} (corresponding to \textbf{m-G3i} from~\cite{basicprooftheory}) substitute R$\to$ with
		\begin{center}
			\AxiomC{$A, \Gamma\Rightarrow B$}
			\RightLabel{R$\to'$}
			\UnaryInfC{$\Gamma\Rightarrow\Delta, A\to B$}
			\DisplayProof
		\end{center}
	
		A \textit{proof} of a formula $\varphi$ in a calculus $\mathbf{G}$ is a labelled binary rooted tree in which every node is labelled with a pair of the name of a rule in $\mathbf{G}$, its rule, and a sequent, its sequent, such that
		\begin{itemize}
			\item Every leaf is labelled with (Ax, $A,\Gamma\Rightarrow\Delta, A$) or (L$\bot$, $\bot, \Gamma\Rightarrow\Delta$) for some formula $A$, multi-sets of formulas $\Gamma,\Delta$.
			\item The sequent of an interior node can be derived from sequents of its child nodes according to its rule.
		\end{itemize}
		We usually present a proof directly as a sequence of applications of rules rather than in a more usual tree presentation. Note that we implicitly permute the antecedent and succedent, i.e. we implicitly may apply a number of exchange rules at any point in the proof. 
	\end{definition}

	\begin{example}
		The following is a proof of $(A\to B)\to A\Rightarrow B$:
		\begin{center}
			\AxiomC{}
			\RightLabel{Ax}
			\UnaryInfC{$A\to B, A\Rightarrow B, A$}
			\AxiomC{}
			\RightLabel{Ax}
			\UnaryInfC{$A, B\Rightarrow B$}
			\RightLabel{L$\to$}
			\BinaryInfC{$A\to B, A\Rightarrow B$}
			\DisplayProof
		\end{center}
	\end{example}

	\noindent We now recall some important properties of the given systems:
   
		
	\begin{theorem}[subformula property]
		Any formula that appears in a derivation is a subformula of a forumla that occurs in the root sequent.
	\end{theorem}
	
	We consider the following additional rules, which are not a priori part of our calculus:
		\begin{center}
		\begin{tabular}{lll}
			\AxiomC{$\Gamma\Rightarrow\Delta$}
			\RightLabel{Lweak}
			\UnaryInfC{$A,\Gamma\Rightarrow \Delta$}
			\DisplayProof&
			\AxiomC{$\Gamma\Rightarrow\Delta$}
			\RightLabel{Rweak}
			\UnaryInfC{$\Gamma\Rightarrow \Delta, A$}
			\DisplayProof&
			\\&&\\
			\AxiomC{$A, A,\Gamma\Rightarrow\Delta$}
			\RightLabel{Lcontr}
			\UnaryInfC{$A, \Gamma\Rightarrow \Delta$}
			\DisplayProof&
			\AxiomC{$\Gamma\Rightarrow\Delta, A, A$}
			\RightLabel{Rcontr}
			\UnaryInfC{$\Gamma\Rightarrow \Delta, A$}
			\DisplayProof&
			\\&&\\
		\end{tabular}
	
		\AxiomC{$\Gamma\Rightarrow A, \Delta$}
		\AxiomC{$\Gamma', A\Rightarrow \Delta'$}
		\RightLabel{Cut}
		\BinaryInfC{$\Gamma, \Gamma'\Rightarrow\Delta, \Delta'$}
		\DisplayProof
	\end{center}


	The following central result of proof theory will be useful to us in many places:
	\begin{theorem}[admissibility of cut (and structural rules)]
		The 5 above rules are admissible in our calculi for classical and intuitionistic logic, i.e. adding them we are not able to prove any additional theorems.
	\end{theorem}


	This means that we may assume that all proofs are free of these rules, but in constructing new proofs we may apply them. We exclude them from our calculus to keep it simple for proofs and because cut destroys the subformula property.

	\section{The Translation Procedure}
	
	\begin{definition}
		We say that two sequents $S, S'$ are \textit{equiprovable} if $S$ is intuitionistically provable iff $S'$ is intuitionistically provable and write $$S\sim_p S'.$$
	\end{definition}

	Clearly equiprovability is an equivalence relation. Since every sequent is either provable or not the above notion is trivial in a sense. However we can often argue that two sequents are equiprovable even when we cannot determine their individual provability. This is in particular useful when discussing transformations of sequents that are to preserve intuitionistic provability.
	
	\begin{example}
		The sequents $\Rightarrow A\vee B$ and $A\to C, B\to C\Rightarrow C$ are equiprovable. Note that they are not equivalent in the typical sense however, due to the absence of $C$ in the former. 
	\end{example}

		The reason that equivalence is insufficient for our procedure is that new atoms may be introduced. In trying to reverse double negation translation this is to be expected however: In double negation translation we collapse the veracity of $A$ and $\neg\neg A$, which are not intuitionistically equivalent. In our case we do the opposite, i.e. we must modifiy our formula such that $A$ and $\neg\neg A$ are no longer classically equivalent. For that we require new atoms.

		However there is clearly some connection between the two notions:
		
		\begin{lemma}\label{ep1}
			Let $A$ and $B$ be equivalent formulas, i.e. $A\Rightarrow B$ and $B\Rightarrow A$ are provable. Then \begin{enumerate}
				\item $A,\Gamma\Rightarrow\Delta \sim_p B, \Gamma\Rightarrow\Delta$
				\item $\Gamma\Rightarrow\Delta, A\sim_p\Gamma\Rightarrow\Delta, B$
			\end{enumerate}
		\end{lemma}
	
		\begin{proof}
			This is a direct consequence of the admissibility of cut, e.g.
			\begin{center}
				\AxiomC{$\vdots$}
				\noLine
				\UnaryInfC{$A,\Gamma\Rightarrow\Delta$}
				\AxiomC{$\vdots$}
				\noLine
				\UnaryInfC{$B\Rightarrow A$}
				\RightLabel{Cut}
				\BinaryInfC{$B, \Gamma\Rightarrow\Delta$}
				\DisplayProof
			\end{center}
		\end{proof}

		We observe some other basic properties of equiprovability.
	
	\begin{lemma}\label{ep2}
		Let $N$ be a atomic proposition that does not occur in $\Gamma$ or $\Delta$, $A, B$ arbitrary formulas that do not contain $N$, then:
		\begin{enumerate}
			\item $\Gamma\Rightarrow\Delta\sim_p\Gamma\Rightarrow\Delta, N$
			\item $\Gamma\Rightarrow\Delta, A\sim_p\Gamma, A\to N\Rightarrow \Delta, N$
			\item $\Gamma, A, B\Rightarrow\Delta\sim_p\Gamma, A\wedge B\Rightarrow\Delta$
			\item $\Gamma\Rightarrow A\vee B,\Delta\sim_p\Gamma\Rightarrow A, B,\Delta$
		\end{enumerate} 
	\end{lemma}

	\begin{proof}
		1. If $\Gamma\Rightarrow\Delta$ is provable then we obtain a proof of $\Gamma\Rightarrow\Delta, N$ through a simple application of weakening. Suppose on the other hand we have a proof of  $\Gamma\Rightarrow\Delta, N$. Then by the subformula property $N$ may only occur as a pure atom. In particular $N$ can never appear in the antecedent as it would occur in $\Gamma$ then. Since we may assume that our proof does not contain weakenings, $N$ has to be introduced as part of $\Delta$ in the axioms. Therefore removing $N$ from all succedents produces a valid proof of $\Gamma\Rightarrow\Delta$.
		
		2. If $\Gamma\Rightarrow\Delta, A$ is provable we obtain $\Gamma, A\to N\Rightarrow \Delta, N$ through a simple application of cut:
		\begin{center}
			\AxiomC{$\vdots$}
			\noLine
			\UnaryInfC{$\Gamma\Rightarrow\Delta, A$}
			\AxiomC{\hphantom{X}}
			\RightLabel{Ax}
			\UnaryInfC{$A, A\to N\Rightarrow P, A$}
			\AxiomC{\hphantom{X}}
			\RightLabel{Ax}
			\UnaryInfC{$N, A\Rightarrow N$}
			\RightLabel{L$\to$}
			\BinaryInfC{$A, A\to N\Rightarrow N$}
			\RightLabel{Cut}
			\BinaryInfC{$\Gamma, A\to N\Rightarrow\Delta, N$}
			\DisplayProof
		\end{center}
		Suppose on the other hand we have a proof of $\Gamma, A\to N\Rightarrow \Delta, N$. Consider the proof obtained by replacing every occurrence of $N$ with $A$. By induction on the proof height it can be checked that this constitutes a valid proof of $\Gamma, A\to A\Rightarrow\Delta, N$. We obtain $\Gamma\Rightarrow\Delta, A$ through an application fo Cut:
		\begin{center}
			\AxiomC{\hphantom{X}}
			\RightLabel{Ax}
			\UnaryInfC{$A \Rightarrow A$}
			\RightLabel{R$\to$}
			\UnaryInfC{$\Rightarrow A\to A$}
			\AxiomC{$\vdots$}
			\noLine
			\UnaryInfC{$\Gamma, A\to A\Rightarrow\Delta, A$}
			\RightLabel{Cut}
			\BinaryInfC{$\Gamma\Rightarrow\Delta, A$}
			\DisplayProof
		\end{center}
	
		3. Going from $\Gamma, A, B\Rightarrow\Delta$ to $\Gamma, A\wedge B\Rightarrow\Delta$ is a single $L\wedge$ step. The other direction is a simple application of Cut:
		
		\begin{center}
			\AxiomC{\hphantom{X}}
			\RightLabel{Ax}
			\UnaryInfC{$A, B \Rightarrow A$}
			\AxiomC{\hphantom{X}}
			\RightLabel{Ax}
			\UnaryInfC{$A, B \Rightarrow B$}
			\RightLabel{R$\wedge$}
			\BinaryInfC{$A, B \Rightarrow A\wedge B$}
			\AxiomC{$\vdots$}
			\noLine
			\UnaryInfC{$\Gamma, A\wedge B\Rightarrow\Delta$}
			\RightLabel{Cut}
			\BinaryInfC{$\Gamma, A, B\Rightarrow\Delta$}
			\DisplayProof
		\end{center}
		
		4. Analogous to 3.
	\end{proof}

	\begin{definition}
		A sequent $\Gamma\Rightarrow \Delta$ is \textit{implicational} if each formula $A$ in $\Gamma$ is of the form $C_A\to (D_A\to E_A)$, $(C_A\to D_A)\to E_A$, $C_A\to D_A$ or $C_A$ for some atomic $C_A, D_A, E_A$ and each formula $B$ in $\Delta$ is of the form $C_B$ or $C_B\to D_B$ for some atomic $C_B, D_B$.
	\end{definition}

	While at first this might seems quite restrictive we can give a translation procedure that transforms every sequent into an equiprovable implicational sequent - even one containing a single atom in the succedent - so in some sense this is a normal form for intuitionistic sequents. One nice property of implicational sequents is that their proofs consist of implicational sequents and contain only the rules Ax, L$\bot$, L$\to$ and R$\to$
	
	The translation steps are reminiscent of the definitions of connectors in second order logic. Consider the following rules, where $X$ is not atomic, $N$ is a new atom:
	\begin{center}
		\begin{tabular}{clcl}
			(1)&$\Gamma\Rightarrow \Gamma, A, B$&$\rightsquigarrow$&$\Gamma\Rightarrow\Gamma, A\vee B$\\
			(2)&$\Gamma\Rightarrow A\to B$&$\rightsquigarrow$&$\Gamma, A\Rightarrow B$\\
			(3)&$\Gamma\Rightarrow A\vee B$&$\rightsquigarrow$&$\Gamma, (A\vee B)\to N\Rightarrow N$\\
			(4)&$\Gamma\Rightarrow A\wedge B$&$\rightsquigarrow$&$\Gamma,(A\wedge B)\to N\Rightarrow N$\\
			
			(5)&$\Gamma, A\wedge B\Rightarrow C$&$\rightsquigarrow$&$\Gamma, A, B\Rightarrow C$\\
			(6)&$\Gamma, A\vee B\Rightarrow C$&$\rightsquigarrow$&$\Gamma, (A\to C)\to (B\to C)\to N\Rightarrow  N$\\
			(7)&$\Gamma, (A\wedge B)\to C\Rightarrow D$&$\rightsquigarrow$&$\Gamma, A\to (B\to C)\Rightarrow D$\\
			(8)&$\Gamma, (A\vee B)\to C\Rightarrow D$&$\rightsquigarrow$&$\Gamma, A\to C, B\to C\Rightarrow D$\\
			(9)&$\Gamma, A\to (B\wedge C)\Rightarrow D$&$\rightsquigarrow$&$\Gamma, A\to B, A\to C\Rightarrow D$\\
			(10)&$\Gamma, A\to (B\vee C)\Rightarrow D$&$\rightsquigarrow$&$\Gamma, A\to (B\to D)\to (C\to D)\to N\Rightarrow N$\\
			(11)&$\Gamma, X\to A\to B\Rightarrow C$&$\rightsquigarrow$&$\Gamma, X\to N, N\to (A\to B)\Rightarrow C$\\
			(12)&$\Gamma, A\to X\to B\Rightarrow C$&$\rightsquigarrow$&$\Gamma, X\to N, A\to (N\to B)\Rightarrow C$\\
			(13)&$\Gamma, A\to B\to X\Rightarrow C$&$\rightsquigarrow$&$\Gamma, N\to X, A\to (B\to N)\Rightarrow C$\\
			(14)&$\Gamma, (X\to A)\to B\Rightarrow C$&$\rightsquigarrow$&$\Gamma, N\to X, (N\to A)\to B\Rightarrow C$\\
			(15)&$\Gamma, (A\to X)\to B\Rightarrow C$&$\rightsquigarrow$&$\Gamma, X\to N, (A\to N)\to B\Rightarrow C$\\
			(16)&$\Gamma, (A\to B)\to X\Rightarrow C$&$\rightsquigarrow$&$\Gamma, N\to X, (A\to B)\to N\Rightarrow C$\\
		\end{tabular}
	\end{center}

	\begin{example}\hphantom{x}
	\begin{center}
		\begin{tabular}{ll}
			&$(A\to B)\to (C\vee D)\to E\Rightarrow F\vee G$\\
			$\rightsquigarrow$&$(A\to B)\to (C\vee D)\to E, F\to N, G\to N\Rightarrow N$\\
			$\rightsquigarrow$&$(A\to B)\to M, M\to (C\vee D)\to E, F\to N, G\to N\Rightarrow N$\\
			$\rightsquigarrow$&$(A\to B)\to M, M\to O\to E, (C\vee D)\to O, F\to N, G\to N\Rightarrow N$\\
			$\rightsquigarrow$&$(A\to B)\to M, M\to O\to E, C\to O, D\to O, F\to N, G\to N\Rightarrow N$\\
		\end{tabular}
	\end{center}
	\end{example}

	\begin{lemma}
		Iteratively applying the above transformations we can obtain from every sequent $S$ an equiprovable implicational sequent $S_\to$.
	\end{lemma}

	\begin{proof}[Proof]
		
		There are three things to check: 1. There is an applicable transformation for every non-implicational sequent. 2. The translation procedure terminates on every input. 3. The sequents involved in every transformation are equiprovable.
		
		1. Suppose $\Gamma\Rightarrow\Delta$ is not implicational. Then the succedent is not a single atom, or there is a formula in the antecedent that is not of the form $(C\to D)\to E, C\to (D\to E), C\to D$ or $D$ for some atoms $C, D, E$. If the succedent is not a single atom one of transformations (1)-(4) is applicable. If it is but the antecedent contains a formula which is not an implication (5) or (6) are. If that formula is an implication but one of its arguments is not then (7)-(10) are applicable. Finally if it is an implication of implications but the involved formulas are not atomic one of the rules (11)-(16) applies.

		2. We proceed by defining a well-founded order on the set of sequents $\mathcal S$ and showing that each of the transformations is reductive. Define the complexity $c(\varphi)$ of a formula as usual as $c(A) = 0$ for atoms $A$ and $c(A\circ B) = c(A) + c(B) + 1$ for $\circ\in\{\wedge,\vee,\to\}$. $c$ induces a partial order $<_c$ on formulas. We can extend this to a ordering $<_{DM}$ on finite multisets of formulas $\mathcal M$, also knows as the Dershowitz-Manna ordering as follows:
		
		$M <_{DM}N$ iff there exist $X, Y\in\mathcal{M}$ such that
		\begin{itemize}
			\item $X\subseteq N$ is non-empty,
			\item $M = (N \setminus X) \cup Y$,
			\item for all $y\in Y$ there exists $x\in X$ such that $y <_S x$.
		\end{itemize}
		Since $<_c$ is well-founded so is $<_{DM}$~\cite{Dershowitz-Manna_1979}. Now consider the lexicographic order $\ll$ on $\mathcal{S}^5$ induced by the following orders:
		\begin{enumerate}[(i)]
			\item $(\Gamma\Rightarrow\Delta)\ll(\Gamma'\Rightarrow\Delta')$ iff $|\Delta| < |\Delta'|$ 
			\item $(\Gamma\Rightarrow\Delta)\ll(\Gamma'\Rightarrow\Delta')$ iff $\Delta <_{DM} \Delta'$
			\item $(\Gamma\Rightarrow\Delta)\ll(\Gamma'\Rightarrow\Delta')$ iff the number of occurrences of $\wedge$ in $\Gamma$ is lower than in $\Gamma' $.
			\item $(\Gamma\Rightarrow\Delta)\ll(\Gamma'\Rightarrow\Delta')$ iff the number of occurrences of $\vee$ in $\Gamma$ is lower than in $\Gamma' $.
			\item $(\Gamma\Rightarrow\Delta)\ll(\Gamma'\Rightarrow\Delta')$ iff $\Gamma <_{DM}\Gamma $.
		\end{enumerate}
		Then the diagonal of $\ll$ is our desired order $<$. Since each involved order is well-founded so is $\ll$ and therefore also $<$. Now every transformation is reductive with regard to $<$, i.e. (1) is reductive w.r.t (i), (2)-(4) are reductive w.r.t. (ii), (5), (7), (9) are reductive w.r.t (iii), (6), (8), (10) w.r.t 4 (iv) and (11) - (16) w.r.t. (v) and non are increasing with any of the higher orders. This proves termination.
		 
		3. For most cases equiprovability follows from Lemmas \ref{ep1} and \ref{ep2}, e.g. consider $$\Gamma, A\to (B\wedge C)\Rightarrow D\indent\rightsquigarrow\indent\Gamma, A\to B, A\to C\Rightarrow D$$Then we have
		\begin{align*}
			\Gamma, A\to (B\wedge C)\Rightarrow D&\overset{\ref{ep1}.1}{\sim_p}\Gamma, (A\to B)\wedge (A\to C)\Rightarrow D\\&\overset{\ref{ep2}.3}{\sim_p}\Gamma, A\to B, A\to C\Rightarrow D
		\end{align*}
		
		Some cases require simple applications of cut using intuitionistic tautologies, e.g. for
		$$\Gamma, A\vee B\Rightarrow C\indent\rightsquigarrow\indent\Gamma, (A\to C)\to (B\to C)\to N\Rightarrow  N$$
		we have 
		\begin{align*}
			\Gamma, A\vee B\Rightarrow C&\overset{\star}{\sim_p}\Gamma\Rightarrow (A\vee B)\to C\\&\overset{\ref{ep2}.3}{\sim_p}\Gamma\Rightarrow (A\to C)\wedge(B\to C)\\&\overset{\ref{ep2}.2}{\sim_p} \Gamma, ((A\to C)\wedge (B\to C))\to N\Rightarrow N\\&\overset{\ref{ep1}.1}{\sim_p}\Gamma, (A\to C)\to(B\to C)\to N\Rightarrow N.
		\end{align*}
		Where one direction of $\star$ is trivial and the other is obtained via cut with $$A\vee B, (A\vee B)\to C\Rightarrow C$$
		
		For the last 6 rules one direction in obtained via cut and the other one by substituting all occurrences of $N$ in a proof with $X$.
	\end{proof}
	
	This reduces our task to embedding just the implicational sequents from intuitionistic into classical logic. The basic idea is as follows: When intuitionistically proving a sequent via R$\to$ 
	
	\begin{center}
		\AxiomC{$A,\Gamma\Rightarrow B$}
		\RightLabel{R$\to$}
		\UnaryInfC{$\Gamma\Rightarrow \Delta, A\to B$}
		\DisplayProof
	\end{center}
	
	the formulas in $\Delta$ may not play a role in the derivation of $A, \Gamma\Rightarrow B$ whereas in classical logic they can
	
	\begin{center}
		\AxiomC{$A,\Gamma\Rightarrow \Delta, B$}
		\RightLabel{R$\to$}
		\UnaryInfC{$\Gamma\Rightarrow \Delta, A\to B$}
		\DisplayProof
	\end{center}

	We resolve this dichotomy by using a modified formula $A'\to B'$ and a modified antecedent $\Gamma'$ such that the formulas in $\Delta$ are useless for proving $A', \Gamma'\Rightarrow B'$. Furthermore for an implicational formula we know all possible ways R$\to$ can be applied, that is in deriving formulas of type $C\to D$ in the succedent and more indirectly $(C\to D)\to E$ in the antecedent. An additional complication arises due to the possibility that multiple R$\to$ are nested. Taking all these points into consideration we define the following:
	
	\begin{definition}\label{translation}
		Suppose we are given an implicational sequent $\Gamma\to\Delta$ of the form $$\stackanchor{$\{(C_i\to D_i)\to E_i\}_{i\in I}, \{C_j\}_{j\in J},$}{$\{C_k\to D_k\}_{k\in K},\{C_l\to(D_l\to E_l)\}_{l\in L}$}\Rightarrow \{C_m\}_{m\in M}, \{C_n\to D_n\}_{n\in N}$$
		
		Let $\mathcal{A}$ denote the atoms in the sequent. For each $A\in\mathcal{A}-\{\bot\}$ and $S\subseteq I\cup N$ introduce a new atom $A^{S}$, which is a variant of $A$ for the subproof before the applications of R$\to$ associated with $S$. Have $\bot^S = \bot$ in the following:
		\begin{align*}
			\Gamma' = &\:\{(C_i^{S\cup \{i\}}\to D_i^{S\cup\{i\}})\to E_i^{S}\:|\: S\subset I\cup N - i\}
			\\&\cup \{C_{j}^S\:|\:j\in J, S\subset I\cup N\}
			\\&\cup \{C_{k}^S\to D_k^S\:|\:k\in K, S\subset I\cup N\}
			\\&\cup \{C_l^S\to(D_l^S\to E_l^S)\:|\: l\in L, S\subset I\cup N\}
			\\&\cup \{A^S\to A^{S\cup \{i\}}\:|\:A\in\mathcal{A}, S\subsetneq I\cup N, i\in I\cup N - S\}\\
			\Delta' = &\:\{C_m^\emptyset\:|\:m\in M\}\cup \{C_n^{\{n\}}\to D_n^{\{n\}}\:|\: n\in N\}
		\end{align*}
	\end{definition}

	We claim that the sequent $\Gamma'\to\Delta'$ is classically provable iff $\Gamma\to\Delta$ is intuitionistically provable. Note that the blowup of the sequent can be quite large, i.e. $O(2^{|I| + |N|})$. We will see that this will be far more manageable in the first-order case where we can do encodings via terms. Before proving our claim we shall examine some examples. 
	\begin{example}
		Consider \begin{enumerate}
			\item $(A\to \bot)\to \bot\Rightarrow A$
			\item $\Rightarrow A\to B, B\to A$
			\item $(A\to B)\to C, A\to B\Rightarrow C$
			\item $N\to (A\to B), (A\to B)\to C, (N\to C)\to D\Rightarrow D$ 
		\end{enumerate}
	which have the translated versions, where the sets $S$ have been encoded as natural numbers,
	\begin{enumerate}
		\item $(A^1\to \bot)\to \bot, A^0\to A^1\Rightarrow A^0$
		\item $A^0\to A^1, A^1\to A^3, B^0\to B^1, B^1\to B^3\Rightarrow A^1\to B^1, B^2\to A^2$
		\item $\stackanchor{$(A^1\to B^1)\to C^0, A^0\to B^0, A^1\to B^1$}{$A^0\to A^1, B^0\to B^1, C^0\to C^1$}\Rightarrow C^0$
		\item $\stackanchor{$\{N^i\to (A^i\to B^i)\:|\:i\},(A^1\to B^1)\to C^0, (A^3\to B^3)\to C^2$}{$(N^2\to C^2)\to D^0, (N^3\to C^3)\to D^1, \{X^0\to X^i, X^i\to X^3\:|\:i, X\}$}\Rightarrow D^0$ 
	\end{enumerate}
	We can see that the sequents have become quite a lot more complex. As we would expect the first two, which stem from non-intuitionistic tautologies, are not provable. In the first case it boils down to not being able to prove $A_0$ from $A_1$. In the second to not being able to prove $A^2$ from $A^1$ or $B^2$ from $B^1$ ($A^3/B^3$ would be provable!).
	
	The third example features a minimal intuitionistically valid sequent which requires an application or R$\to$. It remains valid,  as $$(A^1\to B^1)\to C^0, A^1\to B^1\Rightarrow C^0$$ is provable. The final sequent is more involved requiring applications of R$\to$. Let's look at the proof of the modified version (with some implicit weakenings):
	\begin{center}
		\hspace*{-2cm}
		\AxiomC{}
		\RightLabel{Ax}
		\UnaryInfC{$N^3\to N^3$}
		\AxiomC{}
		\RightLabel{Ax}
		\UnaryInfC{$N^2\to N^2$}
		\RightLabel{L$\to$}
		\BinaryInfC{$N^2\to N^3, N^2\Rightarrow N^3$}
		\AxiomC{}
		\RightLabel{Ax}
		\UnaryInfC{$A^3\to B^3\Rightarrow A^3\to B^3$}
		\RightLabel{L$\to$}
		\BinaryInfC{$N^2\to N^3, N^3\to (A^3\to B^3), N^2\Rightarrow A^3\to B^3$}
		\AxiomC{}
		\RightLabel{Ax}
		\UnaryInfC{$C^2\Rightarrow C^2$}
		\RightLabel{L$\to$}
		\BinaryInfC{$N^2\to N^3, N^3\to (A^3\to B^3), (A^3\to B^3)\to C^2, N^2\Rightarrow C^2$}
		\RightLabel{R$\to$}
		\UnaryInfC{$N^2\to N^3, N^3\to (A^3\to B^3), (A^3\to B^3)\to C^2\Rightarrow N^2\to C^2$}
		\AxiomC{}
		\RightLabel{Ax}
		\UnaryInfC{$D^0\Rightarrow D^0$}
		\RightLabel{L$\to$}
		\BinaryInfC{$N^2\to N^3, N^3\to (A^3\to B^3), (A^3\to B^3)\to C^2, (N^2\to C^2)\to D^0\Rightarrow D^0$}
		\DisplayProof
	\end{center}
	We can see that above R$\to$ as applied to $N^2\to C^2$ we only see atoms indexed with $2$ and $3$.
	\end{example}
	
	We now proceed to show that this is indeed a valid embedding of implicational sequents into classical logic. To that end we first show that $\Gamma\to\Delta$ and $\Gamma'\to\Delta'$ are equiprovable and then that the existence of a classical proof implies the existence of an intuitionistic proof (the other direction is trivial).
	
	\begin{lemma}\label{equi}
		Let $\Gamma\to\Delta$ be an implicational sequent. Then $\Gamma\to\Delta$ and $\Gamma'\to\Delta'$ are equiprovable.
	\end{lemma}

	\begin{proof}
		We adopt the notation from~\ref{translation}. Suppose $\Gamma'\to\Delta'$ are provable. Consider some proof and rename each atom $A^S$ to $A$. Each formula in the root sequent is then either part of $\Gamma\to\Delta$ or an intuitionistic tautology. Thus modulo some contractions and simple cuts we obtain a valid proof of $\Gamma\to\Delta$. The other direction is much more involved.
		
		Suppose we have a valid proof of $\Gamma\to\Delta$. We proceed by induction on the proof height. If the proof consists of a single Ax/L$\bot$ we can prove $\Gamma'\to\Delta'$ by Ax/L$\bot$ as well. Suppose the last rule is L$\to$:
		\begin{center}
			\AxiomC{$\Gamma\Rightarrow\Delta, A$}
			\AxiomC{$B, \Gamma\setminus\{A\to B\}\Rightarrow\Delta$}
			\RightLabel{L$\to$}
			\BinaryInfC{$\Gamma\Rightarrow\Delta$}
			\DisplayProof
		\end{center}
		with $A\to B\in\Gamma$. There are 3 cases:
		
		1. $A$ and $B$ are both atoms. Then by induction hypothesis $\Gamma'\Rightarrow\Delta', A^\emptyset$ and $\{B^S|S\subset I\cup N\}\cup \Gamma'\setminus\{A^S\to B^S|S\}\Rightarrow\Delta'$, i.e. $\{B^S|S\}\cup \Gamma'\Rightarrow\Delta'$ after weakening, are provable. Observe that for any $S\subset I\cup N$ $$\{A^T\to A^{T\cup \{i\}}\:|\:T\subsetneq S, i\in S - T\}, A^\emptyset, A^S\to B^S\Rightarrow B^S$$ is valid and $\{A^T\to A^{T\cup \{i\}}\:|\:T\subsetneq S, i\in S - T\}\subset\Gamma'$, $A^S\to B^S\in\Gamma$, i.e. we can prove $\Gamma'\Rightarrow\Delta', B^S$ via cut and weakening. From this and $\{B^S|S\}\cup \Gamma'\Rightarrow\Delta'$ we can obtain $\Gamma'\to\Delta'$ via $2^{|I| + |N|}$ cuts. (We don't really need cuts, but this is conceptually simpler and generalizes better to 2. and 3.)
		
		2. $B = C\to D$ where $A, C, D$ are atoms. By induction hypothesis $\Gamma'\Rightarrow\Delta', A^\emptyset$ and $\{C^S\to D^S|S\}\cup \Gamma'\Rightarrow\Delta'$ are provable. The argument is then analogous to 1 but instead of $A^S\to B^S$ we use $A^S\to(C^S\to D^S)$.
		
		3. $A = C\to D$ where $B, C, D$ are atoms. Let $i\in I$ be the index of $A\to B$, i.e. $A\to B = (C_i\to D_i)\to E_i$. Then by induction hypothesis $\Gamma'\to\Delta', C^{\{i\}}\to D^{\{i\}}$ and $\{B^S|S\}\cup \Gamma'\Rightarrow\Delta'$ are provable. Similarly to 1 observe that for any $S\subset I\cup N$ $$\{B^T\to B^{T\cup \{j\}}\:|\:T\subsetneq S, j\in S - T\}, C^{\{i\}}\to D^{\{i\}}, (C^{\{i\}}\to D^{\{i\}})\to B^\emptyset\Rightarrow B^S$$
		is valid and we have $\{B^T\to B^{T\cup \{j\}}\:|\:T\subsetneq S, j\in S - T\}\subseteq \Gamma'$ and also $(C^{\{i\}}\to D^{\{i\}})\to B^\emptyset\in\Gamma'$. The rest is analogous.
		
		Finally suppose the last rule of the proof of $\Gamma\to\Delta$ is R$\to$:
		\begin{center}
			\AxiomC{$\Gamma, A\Rightarrow B$}
			\RightLabel{R$\to$}
			\UnaryInfC{$\Gamma\Rightarrow\Delta$}
			\DisplayProof
		\end{center}
		with $A\to B\in\Delta$. Let $i$ be the index of $A\to B$. Let $\Gamma''$ be $\Gamma'$ in which each formula containing some $X^S$ with $i\notin S$ is deleted evey remaining atom $X^S$ is replaced by $X^{S - i}$. Then by induction hypothesis $$\Gamma'', \{A^S\:|\:S\subseteq I\cup N - i\}\to B^\emptyset$$ is provable. Now rename every atom $X^S$ in the proof of this sequent with $X^{S\cup\{i\}}$ and perform left weakening using the formulas in $\Gamma'$ that contain some $X^S$ where $i\notin S$. This gives us a proof of $\Gamma', \{A^{S\cup\{i\}}S\subset I\cup N - i\}\to B^{\{i\}}$. Finally observe that for all $S\subset I\cup N - i$ $$\{A^{T\cup\{i\}}\to A^{T\cup \{i, j\}}\:|\:T\subsetneq S, j\in S - T\}, A^{\{i\}}\Rightarrow A^{S\cup\{i\}}$$ is valid and $\{A^{T\cup\{i\}}\to A^{T\cup \{i, j\}}\:|\:T\subsetneq S, j\in S - T\}\subset\Gamma'$. Therefore using cut and weakening we obtain $\Gamma', A^{\{i\}}\Rightarrow B^{\{i\}}$ and via R$\to$ and weakening $\Gamma'\Rightarrow\Delta'$.
	\end{proof}
		
	For the following lemma we first need a technical result:
	\begin{lemma}
		Let $\Gamma\Rightarrow\Delta$ be a provable implicational sequent. Then there exists $B\in\Delta\cup\{\bot\}$ such that $\Gamma\Rightarrow B$ is provable.
	\end{lemma}

	\begin{proof}
		
		By induction on the proof height. If it consists of a single Ax, L$\bot$ or the last rule is R$\to$ the claim is clear. Suppose it ends in L$\to$
		\begin{center}
			\AxiomC{$\Gamma\Rightarrow\Delta, A$}
			\AxiomC{$B, \Gamma\setminus\{A\to B\}\Rightarrow\Delta$}
			\RightLabel{L$\to$}
			\BinaryInfC{$\Gamma\Rightarrow\Delta$}
			\DisplayProof
		\end{center}
		
		We apply the induction hypothesis to the first argument. If $\Gamma\Rightarrow B_\Delta$ is valid for some $B_\Delta\in\Delta\cup\{\bot\}$ we are done so suppose $\Gamma\Rightarrow A$. But then applying the induction hypothesis to the second argument we get
		\begin{center}
			\AxiomC{$\Gamma\Rightarrow A$}
			\AxiomC{$B, \Gamma\setminus\{A\to B\}\Rightarrow B_\Delta$}
			\RightLabel{L$\to$}
			\BinaryInfC{$\Gamma\Rightarrow B_\Delta$}
			\DisplayProof
		\end{center}
	\end{proof}
		
	\begin{lemma}\label{classical}
		Let $\Gamma\to\Delta$ be an implicational sequent. Suppose $\Gamma'\to\Delta'$ is classically provable. Then $\Gamma'\to\Delta'$ is intuitionistically provable.
	\end{lemma}
	
	\begin{proof}
		We adopt again the notation from~\ref{translation}. Suppose we have a classical proof of $\Gamma'\to\Delta'$. We give a transformation into an intuitionistic proof.
		
		First observe that we can move applications of R$\to$ downward the proof tree, as long as the resulting right implication is not an active formula, i.e. $\Gamma\to\Delta, A\to B$ is replaced with $A, \Gamma\to \Delta, B$:
		\begin{center}
			\AxiomC{$A, C,\Gamma\Rightarrow\Delta, B, D$}
			\RightLabel{R$\to$}
			\UnaryInfC{$C,\Gamma\Rightarrow\Delta, A\to B, D$}
			\RightLabel{R$\to$}
			\UnaryInfC{$\Gamma\Rightarrow\Delta, A\to B, C\to D$}
			\DisplayProof
			
			$\downarrow$
			
			\AxiomC{$A, C,\Gamma\Rightarrow\Delta, B, D$}
			\RightLabel{R$\to$}
			\UnaryInfC{$A,\Gamma\Rightarrow\Delta, B, C\to D$}
			\RightLabel{R$\to$}
			\UnaryInfC{$\Gamma\Rightarrow\Delta, A\to B, C\to D$}
			\DisplayProof
			
			\AxiomC{$C\to D, A,\Gamma\Rightarrow\Delta, B, D$}
			\RightLabel{R$\to$}
			\UnaryInfC{$ C\to D,\Gamma\Rightarrow\Delta, A\to B, D$}
			\AxiomC{$A, D,\Gamma\Rightarrow\Delta, B$}
			\RightLabel{R$\to$}
			\UnaryInfC{$D,\Gamma\Rightarrow\Delta, A\to B$}
			\RightLabel{L$\to$}
			\BinaryInfC{$ C\to D,\Gamma\Rightarrow\Delta, A\to B$}
			\DisplayProof
			
			$\downarrow$
			
			\AxiomC{$C\to D, A, \Gamma\Rightarrow\Delta, B, D$}
			\AxiomC{$A, D,\Gamma\Rightarrow\Delta, B$}
			\RightLabel{L$\to$}
			\BinaryInfC{$ C\to D, A,\Gamma\Rightarrow\Delta, B$}
			\RightLabel{R$\to$}
			\UnaryInfC{$C\to D,\Gamma\Rightarrow\Delta, A\to B$}
			\DisplayProof
		\end{center}
		Note that in the L$\to$ case it is not a problem if $A\to B$ was not introduced via R$\to$ in one of the branches but via Ax, we then just have to modify Ax accordingly.
		
		Next consider the case where R$\to$ is followed by L$\to$ where the derived sequent is active, in that case we can move both rules downward: 
		\begin{center}
			\AxiomC{$(A\to B)\to C, A, D, \Gamma\Rightarrow\Delta, B, E$}
			\RightLabel{R$\to$}
			\UnaryInfC{$(A\to B)\to C, D, \Gamma\Rightarrow\Delta, A\to B, E$}
			\AxiomC{$C, D,\Gamma\Rightarrow\Delta, E$}
			\RightLabel{L$\to$}
			\BinaryInfC{$(A\to B)\to C, D, \Gamma\Rightarrow\Delta, E$}
			\RightLabel{R$\to$}
			\UnaryInfC{$(A\to B)\to C, \Gamma\Rightarrow\Delta, D\to E$}
			\DisplayProof
			
			$\downarrow$
			
			\AxiomC{$(A\to B)\to C, A, D, \Gamma\Rightarrow\Delta, B, E$}
			\RightLabel{R$\to$}
			\UnaryInfC{$(A\to B)\to C, A, \Gamma\Rightarrow\Delta, B, D\to E$}
			\RightLabel{R$\to$}
			\UnaryInfC{$(A\to B)\to C, \Gamma\Rightarrow\Delta, A\to B, D\to E$}
			\AxiomC{$C, D,\Gamma\Rightarrow\Delta, E$}
			\RightLabel{R$\to$}
			\UnaryInfC{$C, \Gamma\Rightarrow\Delta, D\to E$}
			\RightLabel{L$\to$}
			\BinaryInfC{$(A\to B)\to C, \Gamma\Rightarrow\Delta, D\to E$}
			\DisplayProof			
		\end{center}
		and analogously for L$\to$.
		\begin{center}
			\hspace*{-4cm}
			{\footnotesize
			\AxiomC{$(A\to B)\to C, A, D\to E, \Gamma\Rightarrow\Delta, B, D$}
			\RightLabel{R$\to$}
			\UnaryInfC{$(A\to B)\to C, D\to E, \Gamma\Rightarrow\Delta, A\to B, D$}
			\AxiomC{$C, D\to E,\Gamma\Rightarrow\Delta, D$}
			\RightLabel{L$\to$}
			\BinaryInfC{$(A\to B)\to C, D\to E, \Gamma\Rightarrow\Delta, D$}
			\AxiomC{$(A\to B)\to C, A, E, \Gamma\Rightarrow\Delta, B$}
			\RightLabel{R$\to$}
			\UnaryInfC{$(A\to B)\to C, E, \Gamma\Rightarrow\Delta, A\to B$}
			\AxiomC{$C, E,\Gamma\Rightarrow\Delta$}
			\RightLabel{L$\to$}
			\BinaryInfC{$(A\to B)\to C, E, \Gamma\Rightarrow\Delta$}
			\RightLabel{L$\to$}
			\BinaryInfC{$(A\to B)\to C, D\to E, \Gamma\Rightarrow\Delta$}
			\DisplayProof
		}
			
			$\downarrow$
			
			\hspace*{-3cm}
			{\footnotesize
				\AxiomC{$(A\to B)\to C, A, D\to E, \Gamma\Rightarrow\Delta, B, D$}
				\AxiomC{$(A\to B)\to C, A, E, \Gamma\Rightarrow\Delta, B$}
				\RightLabel{L$\to$}
				\BinaryInfC{$(A\to B)\to C, A, D\to E, \Gamma\Rightarrow\Delta, B$}
				\RightLabel{R$\to$}
				\UnaryInfC{$(A\to B)\to C, D\to E, \Gamma\Rightarrow\Delta, A\to B$}
				\AxiomC{$C, D\to E,\Gamma\Rightarrow\Delta, D$}
				\AxiomC{$C, E,\Gamma\Rightarrow\Delta$}
				\RightLabel{L$\to$}
				\BinaryInfC{$C, D\to E, \Gamma\Rightarrow\Delta$}
				\RightLabel{L$\to$}
				\BinaryInfC{$(A\to B)\to C, D\to E, \Gamma\Rightarrow\Delta$}
				\DisplayProof
			}	
		\end{center}
		where the same remark as before applies. This allows us to move the applications of R$\to$
		\begin{center}
			\AxiomC{$C^S, \Gamma\Rightarrow \Delta, D^S$}
			\RightLabel{R$\to$}
			\UnaryInfC{$\Gamma\Rightarrow \Delta, C^S\to D^S$}
			\DisplayProof
		\end{center}
		such that
		\begin{enumerate}[i.]
			\item no application of R$\to$ below this one with corresponding $S'$ has $S'\supsetneq S$.
			\item if $S\neq\{i\}$ with $i\in N$ then R$\to$ is directly followed by L$\to$ where the derived application is active, i.e.
			\begin{center}
				\AxiomC{$(C^{S\cup\{i\}}\to D^{S\cup\{i\}})\to E^S, C^{S\cup\{i\}}, \Gamma\Rightarrow \Delta, D^{S\cup\{i\}}$}
				\RightLabel{R$\to$}
				\UnaryInfC{$(C^{S\cup\{i\}}\to D^{S\cup\{i\}})\to E^S,\Gamma\Rightarrow \Delta, C^{S\cup\{i\}}\to D^{S\cup\{i\}}$}
				\AxiomC{$\Gamma, E^S\Rightarrow \Delta$}
				\RightLabel{L$\to$}
				\BinaryInfC{$(C^{S\cup\{i\}}\to D^{S\cup\{i\}})\to E^S,\Gamma\Rightarrow \Delta$}
				\DisplayProof
			\end{center}
		\end{enumerate}
	
		We now proceed by induction on the number of R$\to$ in this transformed proof. There are three cases
		
		1. There are no R$\to$ left, then we are done as the proof is already intuitionistically valid.
		
		2. The last rule is R$\to$, i.e. of the form 
		\begin{center}
			\AxiomC{$C^{\{i\}}, \Gamma\Rightarrow \Delta, D^{\{i\}}$}
			\RightLabel{R$\to$}
			\UnaryInfC{$\Gamma\Rightarrow \Delta, C^{\{i\}}\to D^{\{i\}}$}
			\DisplayProof
		\end{center}
		for some $i\in N$. If $C^{\{i\}}, \Gamma\Rightarrow D^{\{i\}}$ perform a renaming in the above proof to one of $\{C^S|S\}, \Gamma\Rightarrow D$. Then by induction hypothesis we obtain an intuitionistic proof of that and reverting the transformation we obtain one of $C^{\{i\}}, \Gamma\Rightarrow D^{\{i\}}$. But then we can apply R$\to$ to obtain $\Gamma\Rightarrow \Delta, C^{\{i\}}\to D^{\{i\}}$. Otherwise $\Gamma\Rightarrow\Delta$ and we are done by weakening.
		
		3. The last two rules are of the form
		\begin{center}
			\AxiomC{$(C^{S\cup\{i\}}\to D^{S\cup\{i\}})\to E^S, C^{S\cup\{i\}}, \Gamma\Rightarrow \Delta, D^{S\cup\{i\}}$}
			\RightLabel{R$\to$}
			\UnaryInfC{$(C^{S\cup\{i\}}\to D^{S\cup\{i\}})\to E^S,\Gamma\Rightarrow \Delta, C^{S\cup\{i\}}\to D^{S\cup\{i\}}$}
			\AxiomC{$\Gamma, E^S\Rightarrow \Delta$}
			\RightLabel{L$\to$}
			\BinaryInfC{$(C^{S\cup\{i\}}\to D^{S\cup\{i\}})\to E^S,\Gamma\Rightarrow \Delta$}
			\DisplayProof
		\end{center}
		then again if $C^{S\cup\{i\}}, \Gamma\Rightarrow D^{S\cup\{i\}}$ is provable perform a renaming to obtain one of $\{C^S|S\}, \Gamma\Rightarrow D$, apply the induction hypothesis, and revert the renaming to obtain an intuitionistically valid proof of $(C^{S\cup\{i\}}\to D^{S\cup\{i\}})\to E^S, C^{S\cup\{i\}}, \Gamma\Rightarrow D^{S\cup\{i\}}$ which we can then use in the above. Otherwise we again obtain that $\Gamma\to\Delta$ is provable on which we just need to perform weakening.
	\end{proof}
	
	From~\ref{equi} and~\ref{classical} we finally obtain the result
	
	\begin{theorem}
		A sequent $S$ in intuitionistically provable if and only if $S'_\to$ is classically provable.
	\end{theorem}

	
	\bibliographystyle{plain}
	\bibliography{references}
	
\end{document}